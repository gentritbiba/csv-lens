# Audit Report: 68525e9

**Date:** 2025-12-09
**Commit:** 68525e9
**Type:** chore
**Summary:** Reduce free tier token limit from 150K to 120K

## Changes Overview

This commit reduces the monthly token allocation for free tier users from 150,000 to 120,000 tokens (a 20% reduction).

## Files Modified

| File | Change |
|------|--------|
| `src/lib/db/schema.ts` | TOKEN_LIMITS.free: 150_000 → 120_000 |
| `src/app/(protected)/settings/page.tsx` | Display text: "150,000 tokens" → "120,000 tokens" |
| `src/__tests__/api/auth-callback.test.ts` | Mock TOKEN_LIMITS updated |
| `src/__tests__/api/stripe-webhook.test.ts` | Mock TOKEN_LIMITS updated |
| `src/__tests__/lib/auth/token-usage.test.ts` | Mock TOKEN_LIMITS updated |
| `src/__tests__/test-utils.tsx` | Default mock tokenLimit updated |

## Impact Analysis

- **Free Users:** Will receive 120,000 tokens/month instead of 150,000
- **Pro Users:** No change (remains at 3,000,000 tokens/month)
- **Existing Users:** Token limit will apply on next billing period reset

## Verification

- Build: Passed
- TypeScript: Passed
- Lint (changed files): Passed

## Notes

- Test fixtures using 150000 as test data (e.g., testing 100% usage scenarios) were intentionally left unchanged as they test specific percentage thresholds, not the actual limit configuration
- UI marketing copy in FAQ, terms, login pages still shows "50,000" which appears to be legacy copy not reflecting actual limits
